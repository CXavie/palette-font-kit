<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Aesthetic Generator — Master Theory</title>

  <link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAJ1SURBVHgB7VdLbtNAEJ2ZtR0SBySOHHio9ED6ByVp6YF7C8S9V+reS5W49At6S6VvPUCih6q9cIs8VImHSAhIHCpInDgl9vS89S6OndhOnCSWCHGklZf17uy8mX0zs4sI/vMh6N77S/6DHzpA995P8h/8YAY8T2u9/2X9e8/zMvY6vAnK8+I0HwDOf8N/Fz8f7mXvBqB77yf5D/5yBozH403m8Pj7+/vtDofX378+9uE6uW4C0BvXvfdV/oMfGfA6u8v+pWv9vXb7mAnj4YtU9e7/6O3V/16P0z6mX6lq/8E/3z+fD5+X8fA5z2XvBkDRvfeT/Ac/asC9vS/7fP0l6I0fXmR3O9v/rB+y6499X/Z7vP0R6Pe9Xfajm8G7H9/uE79698p18m4AEPYIu87zOf7LGeBvUuU/55vj6/nS968+D+Ym6Of9vYv09yH7Pee57N0AkL33p/wHP7YAV7R7Lz0G/zD67uFvY968X6O3mKofT9i3XpX/4EcNyKrvP9e6Gnz9mDdv3G+I30GfA2E+4S/oGfI917P0D2D23p/yH/yoAXNfO6mD/5f0z9FvInBvY968X3N2D4HfgZ7X/M3C58HnZTx8znPZuwFQuPf+lP/gxw3IlfUeE6Y56mX0P8M33LzOdzFmPyS88R66G3xeXtfYfM95Lns3AGTv/ST/wY8aoEHe8zP0T5O+X6Pf5ZpXpW/D1wD0FvS7XPNY+Ppg96f8Bz8ywD3fO+w9X/U56mU0xG/oY30/9DHgTdA93zvsH5fXPUmfc57L3g0A2Xt/yn/wBxlAjvM/H5I9A/8D8Hl53XN+pX/0nU/5D340AyB/mHwF9P5k/fsH8W8X76H27v8AAAAASUVORK5CYII=">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Playfair+Display:wght@500;600;700&family=Roboto:wght@400;700&family=Montserrat:wght@400;700&family=Open+Sans:wght@400;700&family=Lato:wght@400;700&family=Oswald:wght@400;700&family=Merriweather:wght@400;700&family=Lora:wght@400;700&family=Source+Code+Pro:wght@400;700&family=Abril+Fatface&family=Bebas+Neue&family=Poppins:wght@400;700&family=Raleway:wght@400;700&display=swap" rel="stylesheet">

  <style>
    :root {
      --font-heading: 'Playfair Display', serif;
      --font-body: 'Inter', sans-serif;
      --bg-app: #f4f4f5;
      --bg-side: #ffffff;
      --text-main: #1f2933;
      --card-bg: #ffffff;
      --shadow: rgba(0,0,0,0.08);
      --border-color: rgba(0,0,0,0.05);
      --toggle-bg: #e2e8f0;
      --nav-bg: #111827;
    }

    body.dark-mode {
      --bg-app: #000000;
      --bg-side: #0a0a0a;
      --text-main: #eeeeee;
      --card-bg: #121212;
      --shadow: rgba(0,0,0,0.6);
      --border-color: rgba(255,255,255,0.1);
      --toggle-bg: #334155;
      --nav-bg: #000000;
    }

    * { box-sizing: border-box; transition: background 0.4s ease, color 0.3s ease, border 0.3s ease; }

    body {
      margin: 0;
      font-family: var(--font-body);
      background: var(--bg-app);
      color: var(--text-main);
      overflow-x: hidden;
    }

    /* Cleaned Top Navigation */
    .top-nav {
      position: sticky; top: 0; z-index: 100;
      background: var(--nav-bg); color: #fff;
      padding: 0.75rem 2rem;
      display: flex; justify-content: flex-end; align-items: center;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      border-bottom: 1px solid var(--border-color);
    }

    /* Modern Theme Switch */
    .theme-switch-wrapper { display: flex; align-items: center; gap: 12px; font-size: 0.75rem; font-weight: 700; letter-spacing: 1px; }
    .theme-switch {
      position: relative; display: inline-block;
      width: 44px; height: 24px;
    }
    .theme-switch input { opacity: 0; width: 0; height: 0; }
    .slider {
      position: absolute; cursor: pointer;
      top: 0; left: 0; right: 0; bottom: 0;
      background-color: var(--toggle-bg);
      transition: .4s; border-radius: 34px;
    }
    .slider:before {
      position: absolute; content: "";
      height: 18px; width: 18px;
      left: 3px; bottom: 3px;
      background-color: white;
      transition: .4s; border-radius: 50%;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    input:checked + .slider { background-color: #6366f1; }
    input:checked + .slider:before { transform: translateX(20px); }

    .app { display: grid; grid-template-columns: 320px 1fr 280px; min-height: calc(100vh - 48px); }
    aside { padding: 2rem; background: var(--bg-side); overflow-y: auto; }
    .left { border-right: 1px solid var(--border-color); z-index: 5; }
    .right { border-left: 1px solid var(--border-color); z-index: 5; }

    .brand-header {
        display: flex; align-items: center; justify-content: space-between;
        margin-bottom: 2rem; gap: 10px;
    }

    h1, h2, h3 { font-family: var(--font-heading); margin-top: 0; }

    button {
      width: 100%; padding: 0.85rem; border-radius: 12px; border: none;
      cursor: pointer; font-weight: 600; color: #fff; margin-bottom: 1rem;
    }

    .control { font-size: 0.85rem; margin-bottom: 1.5rem; }
    label { display: block; margin-bottom: 0.5rem; font-weight: 500; }
    
    select, input[type="color"] { width: 100%; margin-top: 0.2rem; cursor: pointer; }

    select {
        padding: 0.6rem; border-radius: 8px; border: 1px solid var(--border-color);
        background: var(--card-bg); color: var(--text-main); font-weight: 500;
    }

    #fontSelector { width: auto; font-size: 0.7rem; padding: 4px 8px; max-width: 120px; }

    .palette { display: flex; gap: 0.5rem; margin-bottom: 1.5rem; }
    .swatch {
      flex: 1; height: 65px; border-radius: 10px;
      display: flex; align-items: center; justify-content: center;
      font-size: 0.65rem; font-weight: 700; color: #fff;
      text-shadow: 0 1px 2px rgba(0,0,0,0.4); text-align: center;
    }

    .contrast-badge {
      display: inline-block; padding: 4px 12px; border-radius: 20px;
      font-size: 0.75rem; font-weight: 600; margin-top: 1.5rem;
    }

    main { display: flex; justify-content: center; align-items: center; padding: 2rem; }
    .card {
      background: var(--card-bg); padding: 3rem; border-radius: 28px;
      box-shadow: 0 25px 50px var(--shadow); max-width: 480px; text-align: center;
    }

    .component-demo {
      margin-top: 2rem;
      padding-top: 1.5rem;
      border-top: 1px dashed var(--border-color);
      text-align: left;
    }

    .btn-group { display: flex; flex-direction: column; gap: 12px; margin-top: 1rem; }
    .comp-btn {
      width: 100%; padding: 0.7rem; border-radius: 8px;
      font-weight: 600; cursor: pointer; text-shadow: none;
    }

    .btn-default { border: 1px solid #cbd5e1; background: #fff; color: #334155; }
    body.dark-mode .btn-default { background: #1a1a1a; color: #fff; border-color: #333; }
    .btn-ghost { border: 1px solid transparent; background: transparent; }

    .favorite-item {
      display: flex; flex-direction: column;
      padding: 0.8rem; border-radius: 12px; background: rgba(0,0,0,0.05);
      margin-bottom: 0.75rem; cursor: pointer; gap: 0.5rem;
    }
    body.dark-mode .favorite-item { background: #1a1a1a; }
    .fav-meta { display: flex; justify-content: space-between; align-items: center; font-size: 0.7rem; opacity: 0.7; }
    .mini-palette { display: flex; gap: 4px; flex: 1; }
    .mini-swatch { width: 100%; height: 12px; border-radius: 3px; }
    .delete { color: #ef4444; font-size: 1.2rem; cursor: pointer; padding: 0 5px; }

    #mobileFavToggle {
        display: none;
        position: fixed; bottom: 20px; right: 20px;
        width: 60px; height: 60px; border-radius: 50%;
        z-index: 200; box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        font-size: 1.5rem; align-items: center; justify-content: center;
    }

    @media (max-width: 1024px) {
        .app { grid-template-columns: 320px 1fr; }
        .right { position: fixed; right: -280px; top: 48px; bottom: 0; width: 280px; z-index: 150; }
        .right.open { right: 0; }
        #mobileFavToggle { display: flex; }
    }
  </style>
</head>

<body>

  <nav class="top-nav">
    <div class="theme-switch-wrapper">
      <span>DARK MODE</span>
      <label class="theme-switch">
        <input type="checkbox" id="themeToggle">
        <span class="slider"></span>
      </label>
    </div>
  </nav>

  <button id="mobileFavToggle">★</button>

  <div class="app">
    <aside class="left">
      <div class="brand-header">
        <h1 style="margin:0;">Aesthetic</h1>
        <select id="fontSelector">
            <optgroup label="Modern Sans">
                <option value="'Inter', sans-serif">Inter</option>
                <option value="'Poppins', sans-serif">Poppins</option>
                <option value="'Montserrat', sans-serif">Montserrat</option>
                <option value="'Roboto', sans-serif">Roboto</option>
            </optgroup>
            <optgroup label="Elegant Serif">
                <option value="'Playfair Display', serif">Playfair</option>
                <option value="'Merriweather', serif">Merriweather</option>
                <option value="'Lora', serif">Lora</option>
            </optgroup>
            <optgroup label="Bold/Coding">
                <option value="'Bebas Neue', cursive">Bebas Neue</option>
                <option value="'Source Code Pro', monospace">Source Code</option>
            </optgroup>
        </select>
      </div>
      
      <div class="control">
        <label>Harmony Mode</label>
        <select id="modeSelect">
            <option value="analogous">Analogous</option>
            <option value="monochrome">Monochrome</option>
            <option value="complementary">Complementary</option>
            <option value="triadic">Triadic</option>
        </select>
      </div>

      <div class="control">
        <label>Base Color</label>
        <input type="color" id="baseColor" value="#6366f1">
      </div>

      <div class="palette">
        <div class="swatch" id="primary"></div>
        <div class="swatch" id="secondary"></div>
        <div class="swatch" id="accent"></div>
      </div>

      <button id="generate">Generate Style</button>
      <button id="save" style="border: 1px solid rgba(255,255,255,0.2);">Save Favorite</button>
      <button id="downloadCSS" style="background: #475569;">Download CSS</button>
      <button id="export">Export JSON</button>
    </aside>

    <main>
      <div class="card" id="previewCard">
        <h2 id="previewHeader">Design System</h2>
        <p>Interface colors are calculated automatically based on your base color and harmony mode.</p>
        <div id="contrastBadge" class="contrast-badge">Contrast: --</div>

        <div class="component-demo">
            <h3 style="font-size: 0.8rem; margin-bottom: 1rem; opacity: 0.7; font-family: sans-serif; text-transform: uppercase; letter-spacing: 1.5px;">UI Components</h3>
            <div class="btn-group">
              <button class="comp-btn btn-primary" id="uiPrimary">Primary Action</button>
              <button class="comp-btn btn-default" id="uiDefault">Default Outline</button>
              <button class="comp-btn btn-ghost" id="uiGhost">Ghost Button</button>
            </div>
          </div>
      </div>
    </main>

    <aside class="right" id="favoritesSidebar">
      <h3>Favorites</h3>
      <div id="favorites"></div>
    </aside>
  </div>

  <script>
    const generateBtn = document.getElementById('generate');
    const saveBtn = document.getElementById('save');
    const exportBtn = document.getElementById('export');
    const downloadCSSBtn = document.getElementById('downloadCSS');
    const favoritesEl = document.getElementById('favorites');
    const baseColorInput = document.getElementById('baseColor');
    const modeSelect = document.getElementById('modeSelect');
    const themeToggle = document.getElementById('themeToggle');
    const fontSelector = document.getElementById('fontSelector');
    const mobileFavToggle = document.getElementById('mobileFavToggle');
    const favoritesSidebar = document.getElementById('favoritesSidebar');
    const contrastBadge = document.getElementById('contrastBadge');
    
    const previewCard = document.getElementById('previewCard');
    const previewHeader = document.getElementById('previewHeader');
    
    const uiPrimary = document.getElementById('uiPrimary');
    const uiGhost = document.getElementById('uiGhost');

    const swatches = {
      primary: document.getElementById('primary'),
      secondary: document.getElementById('secondary'),
      accent: document.getElementById('accent')
    };

    let current = null;

    mobileFavToggle.onclick = () => {
        favoritesSidebar.classList.toggle('open');
        mobileFavToggle.textContent = favoritesSidebar.classList.contains('open') ? '✕' : '★';
    };

    fontSelector.addEventListener('change', () => {
        const font = fontSelector.value;
        document.querySelectorAll('#previewCard, #previewHeader, .comp-btn').forEach(el => {
            el.style.fontFamily = font;
        });
        if (current) current.font = font;
    });

    function getLuminance(r, g, b) {
      let [rs, gs, bs] = [r/255, g/255, b/255].map(v => 
        v <= 0.03928 ? v / 12.92 : Math.pow((v + 0.055) / 1.055, 2.4)
      );
      return 0.2126 * rs + 0.7152 * gs + 0.0722 * bs;
    }

    function checkContrast(hex1, hex2) {
      const rgb1 = hexToRgb(hex1);
      const rgb2 = hexToRgb(hex2);
      if (!rgb1 || !rgb2) return 1;
      const l1 = getLuminance(rgb1.r, rgb1.g, rgb1.b);
      const l2 = getLuminance(rgb2.r, rgb2.g, rgb2.b);
      return ((Math.max(l1, l2) + 0.05) / (Math.min(l1, l2) + 0.05)).toFixed(2);
    }

    function hexToRgb(hex) {
      const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
      return result ? { r: parseInt(result[1], 16), g: parseInt(result[2], 16), b: parseInt(result[3], 16) } : null;
    }

    function rgbToHex(rgb) {
        const parts = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
        if (!parts) return "#FFFFFF";
        return "#" + [parts[1], parts[2], parts[3]].map(x => parseInt(x).toString(16).padStart(2, '0')).join('').toUpperCase();
    }

    function hslToHex(h, s, l) {
      l /= 100; s /= 100;
      const a = s * Math.min(l, 1 - l);
      const f = n => {
        const k = (n + h / 30) % 12;
        const color = l - a * Math.max(Math.min(k - 3, 9 - k, 1), -1);
        return Math.round(255 * color).toString(16).padStart(2, '0');
      };
      return `#${f(0)}${f(8)}${f(4)}`.toUpperCase();
    }

    function hexToHsl(hex) {
      let r = parseInt(hex.slice(1,3), 16) / 255;
      let g = parseInt(hex.slice(3,5), 16) / 255;
      let b = parseInt(hex.slice(5,7), 16) / 255;
      const max = Math.max(r, g, b), min = Math.min(r, g, b);
      let h, s, l = (max + min) / 2;
      if (max === min) h = s = 0;
      else {
        const d = max - min;
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
        switch (max) {
          case r: h = (g - b) / d + (g < b ? 6 : 0); break;
          case g: h = (b - r) / d + 2; break;
          case b: h = (r - g) / d + 4; break;
        }
        h /= 6;
      }
      return [h * 360, s * 100, l * 100];
    }

    function apply(style) {
      current = style;
      const bgHex = rgbToHex(getComputedStyle(previewCard).backgroundColor);
      const p = style.palette;

      const primaryHex = hslToHex(p.primary[0], p.primary[1], p.primary[2]);
      const secondaryHex = hslToHex(p.secondary[0], p.secondary[1], p.secondary[2]);
      const accentHex = hslToHex(p.accent[0], p.accent[1], p.accent[2]);

      baseColorInput.value = primaryHex;

      if(style.font) {
          fontSelector.value = style.font;
          document.querySelectorAll('#previewCard, #previewHeader, .comp-btn').forEach(el => {
            el.style.fontFamily = style.font;
          });
      }

      swatches.primary.style.background = primaryHex; swatches.primary.textContent = primaryHex;
      swatches.secondary.style.background = secondaryHex; swatches.secondary.textContent = secondaryHex;
      swatches.accent.style.background = accentHex; swatches.accent.textContent = accentHex;

      generateBtn.style.background = primaryHex;
      saveBtn.style.background = secondaryHex;
      exportBtn.style.background = accentHex;
      previewHeader.style.color = primaryHex;
      previewCard.style.borderTop = `12px solid ${primaryHex}`;

      uiPrimary.style.background = primaryHex;
      uiGhost.style.color = primaryHex;
      uiGhost.onmouseover = () => uiGhost.style.background = `${primaryHex}15`;
      uiGhost.onmouseout = () => uiGhost.style.background = `transparent`;

      const ratio = checkContrast(primaryHex, bgHex);
      contrastBadge.textContent = `Contrast Ratio: ${ratio}:1`;
      contrastBadge.style.background = ratio > 4.5 ? '#10b981' : '#f59e0b';
      contrastBadge.style.color = '#fff';
    }

    function updateFromInputs() {
      const mode = modeSelect.value;
      const [h, s, l] = hexToHsl(baseColorInput.value);
      let palette = { primary: [h, s, l] };

      if(mode === 'monochrome') {
          palette.secondary = [h, Math.max(0, s - 30), Math.min(100, l + 20)];
          palette.accent = [h, Math.max(0, s - 10), Math.max(0, l - 20)];
      } else if(mode === 'analogous') {
          palette.secondary = [(h + 30) % 360, s, l];
          palette.accent = [(h - 30 + 360) % 360, s, l];
      } else if(mode === 'complementary') {
          palette.secondary = [h, Math.max(0, s - 20), Math.min(100, l + 10)];
          palette.accent = [(h + 180) % 360, s, l];
      } else {
          palette.secondary = [(h + 120) % 360, s, l];
          palette.accent = [(h + 240) % 360, s, l];
      }
      apply({ palette, font: fontSelector.value });
    }

    function generateRandomStyle() {
      const h = Math.floor(Math.random() * 360);
      const s = 40 + Math.random() * 40;
      const l = 40 + Math.random() * 20;
      baseColorInput.value = hslToHex(h, s, l);
      updateFromInputs();
    }

    function save() {
      if (!current) return;
      const saved = JSON.parse(localStorage.getItem('styles') || '[]');
      saved.push(JSON.parse(JSON.stringify(current)));
      localStorage.setItem('styles', JSON.stringify(saved));
      renderSaved();
    }

    function renderSaved() {
      favoritesEl.innerHTML = '';
      const saved = JSON.parse(localStorage.getItem('styles') || '[]');
      saved.forEach((style, i) => {
        const item = document.createElement('div');
        item.className = 'favorite-item';
        const pal = document.createElement('div');
        pal.className = 'mini-palette';
        Object.values(style.palette).forEach(p => {
          const sw = document.createElement('div');
          sw.className = 'mini-swatch';
          sw.style.background = hslToHex(p[0], p[1], p[2]);
          pal.appendChild(sw);
        });
        const meta = document.createElement('div');
        meta.className = 'fav-meta';
        meta.innerHTML = `<span>${style.font ? style.font.split(',')[0].replace(/'/g, "") : 'Default'}</span>`;
        const del = document.createElement('span');
        del.className = 'delete'; del.innerHTML = '&times;';
        del.onclick = (e) => { e.stopPropagation(); saved.splice(i, 1); localStorage.setItem('styles', JSON.stringify(saved)); renderSaved(); };
        item.onclick = () => { apply(style); };
        meta.appendChild(del); item.appendChild(pal); item.appendChild(meta);
        favoritesEl.appendChild(item);
      });
    }

    downloadCSSBtn.onclick = () => {
        const p = current.palette;
        const h1 = hslToHex(p.primary[0], p.primary[1], p.primary[2]);
        const h2 = hslToHex(p.secondary[0], p.secondary[1], p.secondary[2]);
        const h3 = hslToHex(p.accent[0], p.accent[1], p.accent[2]);
        const cssContent = `:root {\n  --primary: ${h1};\n  --secondary: ${h2};\n  --accent: ${h3};\n  --font: ${fontSelector.value};\n}`.trim();
        const blob = new Blob([cssContent], { type: 'text/css' });
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = 'style.css';
        a.click();
    };

    exportBtn.onclick = () => {
        const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(current, null, 2));
        const a = document.createElement('a');
        a.href = dataStr;
        a.download = "config.json";
        a.click();
    };

    themeToggle.onchange = () => { document.body.classList.toggle('dark-mode'); updateFromInputs(); };
    baseColorInput.oninput = updateFromInputs;
    modeSelect.onchange = updateFromInputs;
    generateBtn.onclick = generateRandomStyle;
    saveBtn.onclick = save;
    
    renderSaved();
    generateRandomStyle();
  </script>
</body>
</html>
